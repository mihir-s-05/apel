seed: 42
device: cpu

data:
  source: tinystories
  train_split: train
  val_split: validation
  max_train_examples: 2500
  max_val_examples: 400
  min_chars: 16
  streaming: true

model:
  num_plan_states: 6
  chunk_size: 16
  token_dim: 192
  hidden_dim: 512
  fusion_dim: 384
  num_layers: 2
  dropout: 0.1
  planner_context_scale: 1.0
  planner_self_bias: 1.8

train:
  out_dir: runs/tinystories_selfbias_smoke
  seq_len: 96
  stride: 96
  batch_size: 12
  lr: 0.0008
  weight_decay: 0.01
  grad_clip: 1.0
  max_steps: 80
  log_interval: 10
  eval_interval: 40
  val_batches: 10
  preview_interval: 40
  preview_prompt: "Once upon a time"
  preview_tokens: 100
  entropy_reg_weight: 0.01
  usage_balance_weight: 0.2

